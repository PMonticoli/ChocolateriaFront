<div class="fondo">
  <div class="container-fluid">

    <h1 class="text-center text-uppercase titulo text-white py-3">
      Listado de Pedidos
    </h1>
    
    <div class="row">
      <div class="col-sm-4">
        <input type="text" 
        class="form-control mb-2" 
        placeholder="Buscar por socio-punto de venta y/o estado" 
        #txtSearch
        (keyup)="onSearchProduct(txtSearch.value)">
      </div>
      <form [formGroup]="formulario">
        <div class="form-group">
          <div class="row">
            <div class="col-sm-4">
              <input type="date" class="form-control" formControlName="fechaDesde"
              [class.is-invalid]="controlFechaDesde.touched && controlFechaDesde.hasError('required')">
              <span *ngIf="controlFechaDesde.touched && controlFechaDesde.hasError('required')" class="invalid-feedback">
                Fecha desde es requerida
              </span>
            </div>
            <div class="col-sm-4">
              <input type="date" class="form-control" formControlName="fechaHasta"
              [class.is-invalid]="controlFechaHasta.touched && controlFechaHasta.hasError('required')">
              <span *ngIf="controlFechaHasta.touched && controlFechaHasta.hasError('required')" class="invalid-feedback">
                Fecha hasta es requerida
              </span>
            </div>

            <div class="col-sm-4">
              <button class="btn btn-secondary" (click)="obtenerPorFecha()">Filtrar por fecha</button>
            </div>
          </div>
        </div>
      </form>
    </div>    

    <button class="btn btn-primary" (click)="prevPage()">Anteriores</button>
    &nbsp;
  <button class="btn btn-primary" (click)="nextPage()"
    [disabled]="(listado |filtroPedido:page :search).length===0"
    >Siguientes</button>

    <div class="table-responsive">
      <table class="table bg-dark text-white mt-2">
        <thead>
          <tr>
            <th scope="col">Punto de Venta</th>
            <th scope="col">Socio</th>
            <th scope="col">Empleado</th>
            <th scope="col">Estado</th>
            <th scope="col">Observaciones</th>
            <th scope="col">Fecha</th>
            <th scope="col">Detalles</th>
            <th scope="col">Accion</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let p of listado |filtroPedido:page :search">
            <td>{{p.puntoVenta}}</td>
            <td>{{p.socio ? p.socio : '-'}}</td>
            <td>{{p.empleado ? p.empleado : '-'}}</td>
            <td>{{p.estado}}</td>
            <td>{{p.observaciones ? p.observaciones : '-'}}</td>
            <td>{{p.fechaPedido | date:'mediumDate':'UTC'}}</td>
            <td>
                <app-detalles-pedido [pedido]="p"></app-detalles-pedido>
            </td>
            <td>
              <app-estado-pedido (onActualizado)="cargarTabla()" [pedido]="p"></app-estado-pedido>
            </td>
          </tr>
        </tbody>  
      </table>
    </div>

  </div>
</div>